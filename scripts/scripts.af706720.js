!function(){"use strict";angular.module("ionic.contrib.frostedGlass",["ionic"]).factory("$ionicFrostedDelegate",["$rootScope",function(a){return{update:function(){a.$emit("ionicFrosted.update")}}}]).directive("frostedBar",["$timeout","$rootScope","$ionicScrollDelegate",function(a,b,c){var d=function(a){var b=a[0],c=a.parent()[0].querySelector(".scroll");if(c){var d=c.style[ionic.CSS.TRANSFORM],e=parseFloat(d.replace("translate3d(","").split(",")[1])||0,f=c.parentNode.offsetTop,g=b.offsetHeight,h=c.cloneNode(!0),i=document.createElement("div");return i.className="ionic-contrib-blur",i.style.overflow="hidden",i.style.height=g+"px",i.appendChild(h),c.parentNode.addEventListener("scroll",function(a){h.style[ionic.CSS.TRANSFORM]="translate3d(0,"+(-a.detail.scrollTop+f)+"px, 0)"}),h.style[ionic.CSS.TRANSFORM]="translate3d(0,"+(e+f)+"px, 0)",a.append(i),i}};return{restrict:"AC",link:function(c,e,f,g){var h=null;b.$on("ionicFrosted.update",function(){ionic.requestAnimationFrame(function(){h&&(h.remove(),h=d(e))})}),a(function(){ionic.requestAnimationFrame(function(){h=d(e)})})}}}])}(),angular.module("starter",["ionic","starter.controllers","ngCordova","ngCordovaOauth","LocalStorageModule","pascalprecht.translate","toaster","ui.bootstrap","satellizer","angular-loading-bar","btford.socket-io","ionic.contrib.frostedGlass","ngFileUpload"]).run(["$ionicPlatform","$rootScope","$state","$location","SessionService",function(a,b,c,d,e){b.$on("$stateChangeStart",function(a,b,d,f){var g=void 0!==b.data&&b.data.requireLogin&&!e.isToken().isLoggedIn;if(g)return c.go("login"),void a.preventDefault();if(e.isToken().isLoggedIn){""===f.name&&"app.newFeed"!==b.name}else;}),a.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}]).config(["$stateProvider","$urlRouterProvider","$authProvider","$httpProvider","cfpLoadingBarProvider","$ionicConfigProvider",function(a,b,c,d,e,f){a.state("login",{url:"/login",templateUrl:"views/login.html",controller:"LoginCtrl"}).state("app",{url:"/app","abstract":!0,templateUrl:"views/menu.html",controller:"AppCtrl",data:{requireLogin:!0}}).state("app.home",{url:"/home",views:{menuContent:{templateUrl:"views/states/home.html",controller:"HomeCtrl"}},data:{requireLogin:!0}}).state("app.newFeed",{url:"/newFeed",views:{menuContent:{templateUrl:"views/states/new_feed.html",controller:"NewFeedCtrl"}},data:{requireLogin:!0}}).state("app.call",{url:"/call",views:{menuContent:{templateUrl:"views/states/call.html",controller:"CallCtrl"}},data:{requireLogin:!0}}).state("app.profile",{url:"/profile",views:{menuContent:{templateUrl:"views/states/profile.html",controller:"ProfileCtrl"}},data:{requireLogin:!0}}).state("app.profileUser",{url:"/profile/:id",views:{menuContent:{templateUrl:"views/states/profile.html",controller:"ProfileCtrl"}},data:{requireLogin:!0}}).state("app.profileEdit",{url:"/profileEdit",views:{menuContent:{templateUrl:"views/states/profile_edit.html",controller:"ProfileCtrl"}},data:{requireLogin:!0}}).state("app.roomChat",{url:"/roomChat",views:{menuContent:{templateUrl:"views/states/room_chat.html",controller:"RoomChatCtrl"}},data:{requireLogin:!0}}),b.otherwise("/login"),e.spinnerColor="#ef473a",e.barColor="#ef473a",d.defaults.headers.post["Content-Type"]="application/json",d.defaults.headers.put["Content-Type"]="application/json",d.defaults.headers.common["Content-Type"]=d.defaults.headers.post["Content-Type"],f.views.transition("none"),f.views.maxCache(0)}]),angular.module("starter").constant("APP_CONFIG",{url:"http://128.199.122.207:7000/",baseUrl:"http://128.199.122.207:7000/api/",urlVideo:"128.199.122.207",portVideo:8100,bucket:"stove-arstist",accessKeyId:"AKIAJSK66SZMN3RRNS2Q",secretKey:"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",actions:{1:"like",2:"unlike",3:"following",4:"unfollow",5:"comment",6:"post status"}}),angular.module("starter").config(["$translateProvider",function(a){a.translations("en",{LOGIN_TO_ACCOUNT:"Log in to account",FORGOT_PASSWORD:"Forgot password?",SIGNUP:"Sign Up",SIGNIN:"Sign In",CREATE_ACC:"Create Account",NEED_HELP:"Need help?",ALREADY_SRESTAURANT:"Already on sRestaurant",LOG_IN:"Log in",WELCOME:"Welcome to vChat <i class='ion-happy-outline'></i> <br/> (small social & video call) ",MESSAGE_WELCOME:"At Stafford's Pier Restaurant, we have put a great deal of energy into assuring that our guests are welcomed and treated as family while dining at our property.",SKIP:"Skip",RESTAURANTS:"List restaurants",NEARBY:"Nearby",FAVOURITES:"Favourites",PROFILE:"Profile",HELLO:"Hello!",SUBTITLE:"Today's sRestaurant Picks",CONTENT:"We've picked 10 restaurants around you. Let see how hungry you are today!",FOR_HERE:"For here",TAKE_OUT:"Take Out",TAKE_UBER:"Take Uber",RATE:"Rate 'em",START_NAV:"Start Navigation",PHOTO:"Photo",ITEMS_IN_CART:"items in your cart.",PLACE_ORDER:"PLACE ORDER",SWIPE_TO:"SWIPE TO",SELECT:"SELECT",EMAIL:"Email",PASSWORD:"Password",RESET_PASS:"Reset password",HOME:"Home",CONTACT:"Contact",FULL_NAME:"Full name"}).translations("vi",{LOGIN_TO_ACCOUNT:"Đăng nhập với tài khoản",FORGOT_PASSWORD:"Lấy lại mật khẩu",SIGNUP:"Đăng ký",SIGNIN:"Đăng nhập",CREATE_ACC:"Tạo tài khoản ",NEED_HELP:"Bạn cần giúp đỡ? ",ALREADY_SRESTAURANT:"Already on sRestaurant",LOG_IN:"Đăng nhập ",WELCOME:"Chào mừng bạn đến với vChat",MESSAGE_WELCOME:"At Stafford's Pier Restaurant, we have put a great deal of energy into assuring that our guests are welcomed and treated as family while dining at our property.",SKIP:"Bỏ qua",RESTAURANTS:"Danh sách nhà hàng ",NEARBY:"Gần nhất ",FAVOURITES:"Favourites",PROFILE:"Thông tin",HELLO:"Xin chào!",SUBTITLE:"Danh sách nhà hàng dành cho bạn hôm nay ",CONTENT:"Chúng tôi đã chọn ra 10 nhà hàng theo khẩu vị và vị trí của bạn. Cám ơn bạn đã quan tâm!",FOR_HERE:"Tại đây",TAKE_OUT:"Mang về ",TAKE_UBER:"Gọi Uber",RATE:"Đánh giá",START_NAV:"Start Navigation",PHOTO:"Ảnh",ITEMS_IN_CART:"đồ trong giỏ hàng",PLACE_ORDER:"PLACE ORDER",SWIPE_TO:"SWIPE TO",SELECT:"SELECT",EMAIL:"Email",PASSWORD:"Mật khẩu",RESET_PASS:"Nhận lại mật khẩu",HOME:"Trang chủ",CONTACT:"Liên hệ"}),a.preferredLanguage("en")}]),angular.module("starter").directive("selectLanguage",function(){return{restrict:"AE",replace:!0,templateUrl:"scripts/directives/select_language.html",controller:["$scope","$translate","localStorageService",function(a,b,c){a.locales=[{name:"English",img:"./images/en.99f4dffe.png",locate:"en"},{name:"Tiếng Việt",img:"./images/vi.5b0b4a80.png",locate:"vi"}],a.selectLangId=function(d){a.selectedLang=d,b.use(a.selectedLang.locate),c.set("language",d)};var d=function(){c.get("language")?a.selectedLang=c.get("language"):a.selectedLang=a.locales[0],b.use(a.selectedLang.locate)};d()}]}}),angular.module("starter").service("SessionService",["localStorageService",function(a){var b={};return b.isToken=function(){var b=!1;if(a.get("stoveCurrentUser")){var c=a.get("stoveCurrentUser");c.token&&(b=!0)}return{isLoggedIn:b}},b}]),angular.module("starter").factory("socket",["socketFactory","APP_CONFIG","$timeout","localStorageService",function(a,b,c,d){var e=io(b.url,{path:"/socket.io-client"}),f=a({ioSocket:e});return{socket:f,syncUpdates:function(a,b,e){e=e||angular.noop,f.on(a+":save",function(f){var g=_.find(b,{_id:f._id}),h=b.indexOf(g),i="created";g?(b.splice(h,1,f),i="updated"):("chat"==a&&(c(function(){var a=document.getElementById("scrollRoomChat");a.scrollTop=a.scrollHeight},0,!1),b.push(f)),"post"==a&&b.unshift(f),"postUser"==a&&d.get("stoveCurrentUser").user._id==f.user._id&&b.unshift(f),"notification"==a&&(c(function(){var a=document.getElementById("scrollNotifications");a.scrollTop=0},0,!1),b.unshift(f))),e(i,f,b)}),f.on(a+":remove",function(a){var c="deleted";_.remove(b,{_id:a._id}),e(c,a,b)})},unsyncUpdates:function(a){f.removeAllListeners(a+":save"),f.removeAllListeners(a+":remove")}}}]),angular.module("starter.controllers",[]).controller("AppCtrl",["$scope","localStorageService","$state","$http","APP_CONFIG","$ionicLoading","cfpLoadingBar","socket","$ionicPopup","$timeout",function(a,b,c,d,e,f,g,h,i,j){a.rootData={},a.rootData.user=b.get("stoveCurrentUser").user,a.rootData.currentUser=b.get("stoveCurrentUser").user,a.rootData.notifications=[],a.rootData.actions=e.actions,g.start(),a.logOut=function(){b.remove("stoveCurrentUser"),a.updateStatusUser(!1),c.go("login")},a.goProfile=function(){c.go("app.profile")},a.updateUser=function(c){a.rootData.currentUser=c;var d=b.get("stoveCurrentUser");d.user=a.rootData.currentUser,b.set("stoveCurrentUser",d)},a.updateStatusUser=function(b){var c={status:b};d.put(e.baseUrl+"users/"+a.rootData.user._id,c).then(function(a){},function(a){})},window.onbeforeunload=function(){a.updateStatusUser(!1)},a.goProfileUser=function(a){c.go("app.profileUser",{id:a})};var k=null;a.rootData.localStream=null,a.rootData.userCaller={},a.getLocalStream=function(b){a.rootData.localStream&&b?b(a.rootData.localStream):navigator.webkitGetUserMedia({audio:!0,video:!0},function(c){a.rootData.localStream=c,a.rootData.localStream.src=window.URL.createObjectURL(c),b&&b(c)},function(a){console.log("failed to access local camera")})},a.updateFollower=function(b){for(var c=!1,d=0;d<a.rootData.currentUser.follows.length;d++)if(b._id==a.rootData.currentUser.follows[d].user._id){a.rootData.currentUser.follows.splice(d,1),c=!0;break}if(!c){var e={user:b};a.rootData.currentUser.follows.push(e)}},a.connect=function(){if(!a.rootData.currentUser._id)return void console.log("please set caller ID first");try{k=new Peer(a.rootData.currentUser._id,{host:e.urlVideo,port:e.portVideo}),k.socket._socket.onclose=function(){console.log("no connection to server"),k=null},k.socket._socket.onopen=function(){console.log("connect server",k)},k.on("call",l)}catch(b){k=null,console.log("error while connecting to server")}},a.stopStream=function(){a.rootData.localStream=null},a.dial=function(){if(!k)return void console.log("please connect first");if(!a.rootData.localStream)return void console.log("could not start call as there is no local camera");var b=a.rootData.userCaller._id;return b?void a.getLocalStream(function(a){var c=k.call(b,a);c.on("stream",n),c.on("error",function(a){console.log("error with call"),console.log(a.message)})}):void console.log("could not start call as no recipient ID is set")};var l=function(b){if(!k)return void console.log("cannot answer a call without a connection");if(!a.rootData.localStream)return void console.log("could not answer call as there is no localStream ready");a.rootData.callerTo=m(b.peer);var c=i.confirm({title:"You have a call from",template:'<div class="popup-video" horizontal layout center><img ng-src="{{rootData.callerTo.avatar}}" alt=""/> <div class="name-video-caller">{{rootData.callerTo.name}}</div></div>',scope:a});c.then(function(c){c?(console.log("You are sure",b),b.on("stream",n),b.answer(a.rootData.localStream)):console.log("You are not sure")}),j(function(){c.close()},1e4)},m=function(b){for(var c=0;c<a.rootData.users.length;c++)if(a.rootData.users[c]._id==b)return a.rootData.users[c];return{}};a.rootData.remoteVideo={};var n=function(b){a.rootData.remoteVideo.src=window.URL.createObjectURL(b),a.$apply()};a.updateUserCall=function(b){a.rootData.userCaller=b||{}};var o=function(){a.rootData.user?(d.get(e.baseUrl+"users/"+a.rootData.user._id).then(function(b){a.updateUser(b.data),a.updateStatusUser(!0)},function(a){g.complete(),console.log(a)}),d.get(e.baseUrl+"notifications/").then(function(b){a.rootData.notifications=b.data,h.syncUpdates("notification",a.rootData.notifications)},function(a){console.log(a)})):a.logOut(),d.get(e.baseUrl+"users/public").then(function(b){a.rootData.users=b.data})};o(),a.$on("$destroy",function(){h.unsyncUpdates("post")})}]).filter("trustUrl",["$sce",function(a){return function(b){return a.trustAsResourceUrl(b)}}]),angular.module("starter").controller("LoginCtrl",["$scope","$http","APP_CONFIG","localStorageService","$state","toaster","cfpLoadingBar",function(a,b,c,d,e,f,g){a.data={},a.data.view=1,a.data.user={},a.data.newUser={},a.data.forgot={},a.viewLogin=function(b){a.data.view=b},a.signUp=function(){a.data.newUser.avatar="https://s3-ap-southeast-1.amazonaws.com/stove-arstist/avatar-default.png",a.data.newUser.workAt="no data",a.data.newUser.address="no data",a.data.newUser.studyAt="no data",b.post(c.baseUrl+"users",a.data.newUser).then(function(b){a.data.view=1,f.success({title:"Created!"})},function(a){console.log(a)})},a.login=function(){g.start(),b.post(c.url+"auth/local",a.data.user).then(function(a){a.data.success?(d.set("stoveCurrentUser",a.data),e.go("app.newFeed"),g.complete()):(f.error("Invalid email or password!"),g.complete())},function(a){f.error("Invalid email or password!"),console.log(a),g.complete()})}}]),angular.module("starter").controller("HomeCtrl",["$scope","socket","$http",function(a,b,c){}]),angular.module("starter").controller("NewFeedCtrl",["$scope","socket","$http","APP_CONFIG","cfpLoadingBar","localStorageService",function(a,b,c,d,e,f){a.data={},a.data.posts=[],a.data.status={},a.data.comment={},a.data.like={},a.data.limit=3,a.sizeLimit=10585760,a.uploadProgress=0,a.creds={},a.data.status.albums=[],a.createStatus=function(){e.start(),a.data.status.user=f.get("stoveCurrentUser").user._id,c.post(d.baseUrl+"posts",a.data.status).then(function(b){e.complete(),a.data.status={},a.data.status.albums=[]})},a.data.newComment={},a.addComment=function(b,e){a.data.newComment[e].user=f.get("stoveCurrentUser").user._id,a.data.newComment[e].createdAt=new Date;var g=angular.copy(a.data.newComment[e]);a.data.newComment[e].user=f.get("stoveCurrentUser").user,b.comments.push(a.data.newComment[e]),a.data.newComment={},c.put(d.baseUrl+"posts/comment/"+b._id,g).then(function(a){})},a.addLike=function(b){for(var e=!1,g=0;g<b.likes.length;g++)if(b.likes[g].user._id==f.get("stoveCurrentUser").user._id){a.data.like.id=b.likes[g]._id,b.likes.splice(g,1),e=!0;break}e&&b.likes.push({user:f.get("stoveCurrentUser").user}),a.data.like.user=f.get("stoveCurrentUser").user._id,c.put(d.baseUrl+"posts/like/"+b._id,a.data.like).then(function(b){a.data.like={}})},a.viewComments=function(a){a.limit=a.comments.length},a.userLike=function(a){if(!a)return!1;for(var b=0;b<a.likes.length;b++)if(a.likes[b].user._id==f.get("stoveCurrentUser").user._id)return!0;return!1},a.upload=function(b){e.start(),AWS.config.update({accessKeyId:d.accessKeyId,secretAccessKey:d.secretKey}),AWS.config.region="us-east-1";var c=new AWS.S3({params:{Bucket:d.bucket}});if(b.name){var f=Math.round(parseInt(b.size));if(f>a.sizeLimit)return!1;var g=a.uniqueString()+"-"+b.name,h={Key:g,ContentType:b.type,Body:b,ServerSideEncryption:"AES256"};c.putObject(h,function(b,c){if(b)return!1;var d="https://s3-ap-southeast-1.amazonaws.com/stove-arstist/"+g;a.data.status.albums.push({url:d}),e.complete(),setTimeout(function(){a.uploadProgress=0,a.$digest()},4e3)}).on("httpUploadProgress",function(b){a.uploadProgress=Math.round(b.loaded/b.total*100),a.$digest()})}},a.$watch("data.file",function(b){b&&a.upload(b)}),a.fileSizeLabel=function(){return Math.round(a.sizeLimit/1024/1024)+"MB"},a.uniqueString=function(){for(var a="",b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;8>c;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a};var g=function(){e.start(),c.get(d.baseUrl+"posts").then(function(c){e.complete(),a.data.posts=c.data,b.syncUpdates("post",a.data.posts)})};g(),a.$on("$destroy",function(){b.unsyncUpdates("post")})}]),angular.module("starter").controller("CallCtrl",["$scope","socket","$sce","$http","APP_CONFIG","$interval",function(a,b,c,d,e,f){a.data={},a.data.users=[],a.data.timeoutCall=0,a.getLocalStream();var g;a.fight=function(){angular.isDefined(g)||(g=f(function(){a.data.timeoutCall?a.data.timeoutCall--:a.stopFight()},1e3))},a.stopFight=function(){angular.isDefined(g)&&(f.cancel(g),g=void 0)},a.startCall=function(){a.data.timeoutCall=20,a.fight(),a.dial()},a.setUserCall=function(b){a.updateUserCall(b)};var h=function(){d.get(e.baseUrl+"users/public").then(function(c){a.data.users=c.data,b.syncUpdates("user",a.data.users)}),a.connect()};h(),a.$on("$destroy",function(){b.unsyncUpdates("user")}),a.$on("$destroy",function(){})}]),angular.module("starter").controller("ProfileCtrl",["$scope","$http","APP_CONFIG","localStorageService","cfpLoadingBar","toaster","$stateParams","socket",function(a,b,c,d,e,f,g,h){a.data={},a.data.posts=[],a.data.status={},a.data.comment={},a.data.like={},a.data.limit=3,a.sizeLimit=10585760,a.uploadProgress=0,a.creds={},a.data.status.albums=[],a.$watch("data.fileAvatar",function(b){b&&a.upload(b,"avatar")}),a.$watch("data.fileCover",function(b){b&&a.upload(b,"cover")}),a.$watch("data.file",function(b){b&&a.upload(b,"status")}),a.today=function(){a.dt=new Date},a.today(),a.clear=function(){a.dt=null},a.open1=function(){a.popup1.opened=!0},a.dateOptions={formatYear:"yy",startingDay:1},a.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],a.format=a.formats[1],a.altInputFormats=["M!/d!/yyyy"],a.popup1={opened:!1},a.updateProfile=function(){e.start();var d={name:a.data.profile.name,workAt:a.data.profile.workAt,studyAt:a.data.profile.studyAt,address:a.data.profile.address,birthday:a.data.profile.birthday,avatar:a.data.profile.avatar,cover:a.data.profile.cover};b.put(c.baseUrl+"users/"+a.data.profile._id,d).then(function(b){a.updateUser(b.data),e.complete(),f.success({title:"Updated!"})},function(a){e.complete(),f.error("Error!")})},a.upload=function(b,d){e.start(),AWS.config.update({accessKeyId:c.accessKeyId,secretAccessKey:c.secretKey}),AWS.config.region="us-east-1";var f=new AWS.S3({params:{Bucket:c.bucket}});if(b.name){var g=Math.round(parseInt(b.size));if(g>a.sizeLimit)return!1;var h=a.uniqueString()+"-"+b.name,i={Key:h,ContentType:b.type,Body:b,ServerSideEncryption:"AES256"};f.putObject(i,function(b,c){if(b)return!1;var e="https://s3-ap-southeast-1.amazonaws.com/stove-arstist/"+h;"avatar"==d&&(a.data.profile.avatar=e),"cover"==d&&(a.data.profile.cover=e),"status"==d&&a.data.status.albums.push({url:e}),a.updateProfile(),setTimeout(function(){a.uploadProgress=0,a.$digest()},4e3)}).on("httpUploadProgress",function(b){a.uploadProgress=Math.round(b.loaded/b.total*100),a.$digest()})}},a.fileSizeLabel=function(){return Math.round(a.sizeLimit/1024/1024)+"MB"},a.uniqueString=function(){for(var a="",b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;8>c;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a},a.createStatus=function(){e.start(),a.data.status.user=d.get("stoveCurrentUser").user._id,b.post(c.baseUrl+"posts",a.data.status).then(function(b){e.complete(),a.data.status={},a.data.status.albums=[],i()})},a.data.newComment={},a.addComment=function(e,f){a.data.newComment[f].user=d.get("stoveCurrentUser").user._id,a.data.newComment[f].createdAt=new Date;var g=angular.copy(a.data.newComment[f]);a.data.newComment[f].user=d.get("stoveCurrentUser").user,e.comments.push(a.data.newComment[f]),a.data.newComment={},b.put(c.baseUrl+"posts/comment/"+e._id,g).then(function(a){})},a.addLike=function(e){for(var f=!1,g=0;g<e.likes.length;g++)if(e.likes[g].user._id==d.get("stoveCurrentUser").user._id){a.data.like.id=e.likes[g]._id,e.likes.splice(g,1),f=!0;break}f&&e.likes.push({user:d.get("stoveCurrentUser").user}),a.data.like.user=d.get("stoveCurrentUser").user._id,b.put(c.baseUrl+"posts/like/"+e._id,a.data.like).then(function(b){a.data.like={}})},a.viewComments=function(a){a.limit=a.comments.length},a.userLike=function(a){if(!a)return!1;for(var b=0;b<a.likes.length;b++)if(a.likes[b].user._id==d.get("stoveCurrentUser").user._id)return!0;return!1},a.follow=function(e){a.data.profile.isFollow?a.data.profile.isFollow=!1:a.data.profile.isFollow=!0,a.updateFollower(a.data.profile);var f={user:a.data.profile._id};b.put(c.baseUrl+"users/follow/"+d.get("stoveCurrentUser").user._id,f).then(function(a){})},a.checkFollow=function(){var b=d.get("stoveCurrentUser").user.follows;if(!a.data.profile._id)return!1;for(var c=0;c<b.length;c++)if(a.data.profile._id==b[c].user._id)return!0;return!1};var i=function(){b.get(c.baseUrl+"posts/public/"+d.get("stoveCurrentUser").user._id).then(function(b){a.data.posts=b.data,h.syncUpdates("postUser",a.data.posts),e.complete()}),b.get(c.baseUrl+"posts/albums/"+d.get("stoveCurrentUser").user._id).then(function(b){a.data.albums=b.data})},j=function(){e.start(),g.id?(b.get(c.baseUrl+"users/"+g.id).then(function(d){a.data.profile=d.data,a.checkFollow()&&(a.data.profile.isFollow=a.checkFollow()),e.start(),b.get(c.baseUrl+"posts/public/"+a.data.profile._id).then(function(b){a.data.posts=b.data,h.syncUpdates("postUser",a.data.posts),e.complete()})}),b.get(c.baseUrl+"posts/albums/"+g.id).then(function(b){a.data.albums=b.data})):(a.data.profile=d.get("stoveCurrentUser").user,i())};j(),a.$on("$destroy",function(){h.unsyncUpdates("postUser")})}]),angular.module("starter").controller("RoomChatCtrl",["$scope","$sce","$ionicScrollDelegate","$ionicFrostedDelegate","cfpLoadingBar","$http","APP_CONFIG","socket","localStorageService","$timeout","$state",function(a,b,c,d,e,f,g,h,i,j,k){a.data={},a.data.chats=[],a.data.users=[],a.data.message={},a.enterChat=function(){a.data.message.user=i.get("stoveCurrentUser").user._id,a.data.message.createdAt=new Date;var b=angular.copy(a.data.message);a.data.message={},f.post(g.baseUrl+"chats",b).then(function(a){})};var l=function(){e.start(),f.get(g.baseUrl+"chats").then(function(b){e.complete(),a.data.chats=b.data,h.syncUpdates("chat",a.data.chats),j(function(){var a=document.getElementById("scrollRoomChat");a.scrollTop=a.scrollHeight},0,!1)}),f.get(g.baseUrl+"users/public").then(function(b){a.data.users=b.data,h.syncUpdates("user",a.data.users)})};l(),a.$on("$destroy",function(){h.unsyncUpdates("chat")}),a.$on("$destroy",function(){h.unsyncUpdates("user")})}]),angular.module("starter").run(["$templateCache",function(a){"use strict";a.put("views/login.html",'<ion-view> <ion-content class="login-page" scroll="false" horizontal layout> <div flex class="slide-form balanced-bg" vertical layout> <div horizontal layout center-justified center class="welcome"> <span translate="WELCOME"></span> </div> <div flex style="position: relative"> <ion-slide-box on-slide-changed="slideHasChanged($index)"> <ion-slide> <div class="box"> <img src="./images/v2.1325cb9c.png" alt=""> </div> </ion-slide> <ion-slide> <div class="box"> <img src="./images/v3.5d59a6cd.png" alt=""> </div> </ion-slide> <ion-slide> <div class="box"> <img src="./images/v4.b68595b9.png" alt=""> </div> </ion-slide> </ion-slide-box> </div> </div> <div class="login-form" vertical layout> <div class="title-login"> <span translate="SIGNIN" ng-class="{active: data.view == 1}" ng-click="viewLogin(1)"></span> <span class="pull-right" translate="SIGNUP" ng-class="{active: data.view == 2}" ng-click="viewLogin(2)"></span> </div> <div class="padding-8" flex> <select-language class="pull-right" style="padding: 14px"></select-language> <div ng-if="data.view == 1"> <form name="formLogin" ng-submit="login()"> <div class="input-login padding-8"> <input type="text" placeholder="{{\'EMAIL\' | translate}}" ng-model="data.user.email" required> </div> <div class="input-login padding-8"> <input type="password" placeholder="{{\'PASSWORD\' | translate}}" ng-model="data.user.password" required> </div> <div class="padding-8 button-login"> <button class="button button-light" ng-disabled="!formLogin.$valid" translate="SIGNIN"> </button> </div> </form> <div class="padding-8 text-center" ng-click="viewLogin(3)" translate="FORGOT_PASSWORD"> </div> </div> <div ng-if="data.view == 2"> <form name="formSignUp" ng-submit="signUp()"> <div class="input-login padding-8"> <input type="text" placeholder="{{\'FULL_NAME\' | translate}}" ng-model="data.newUser.name" required> </div> <div class="input-login padding-8"> <input type="text" placeholder="{{\'EMAIL\' | translate}}" ng-model="data.newUser.email" required> </div> <div class="input-login padding-8"> <input type="password" placeholder="{{\'PASSWORD\' | translate}}" ng-model="data.newUser.password" required> </div> <div class="padding-8 button-login"> <button class="button button-light" ng-disabled="!formSignUp.$valid" translate="SIGNUP"> </button> </div> </form> </div> <div ng-if="data.view == 3"> <h4 style="margin-left: 10px">Not support</h4> <form name="formForgot" ng-submit="forGotMail()"> <div class="input-login padding-8"> <input type="text" placeholder="{{\'EMAIL\' | translate}}" ng-model="data.forgot.email" required> </div> <div class="padding-8 button-login"> <button class="button button-light" ng-disabled="!formForgot.$valid" translate="RESET_PASS"> </button> </div> </form> </div> </div> <!--<div class="padding-8 social-login">\n\n                <div class="padding-8 button-login">\n                    <button class="button button-positive" ng-click="login(\'facebook\')">\n                        <i class="ion-social-facebook-outline"></i> Facebook\n                    </button>\n                </div>\n\n                <div class="padding-8 button-login">\n                    <button class="button button-positive">\n                        <i class="ion-social-instagram-outline"></i> Instagram\n                    </button>\n                </div>\n\n                <div class="padding-8 button-login">\n                    <button class="button button-positive">\n                        <i class="ion-social-googleplus-outline"></i> Google\n                    </button>\n                </div>\n\n                <div class="padding-8 button-login">\n                    <button class="button button-positive">\n                        <i class="ion-social-twitter-outline"></i> Twitter\n                    </button>\n                </div>\n\n            </div>--> </div> </ion-content> </ion-view>'),a.put("views/menu.html",'<ion-side-menus enable-menu-with-back-views="false"> <ion-side-menu-content class="content-app" edge-drag-threshold="false" drag-content="false"> <!--<ion-nav-bar class="bar-stable">\n          <ion-nav-back-button>\n          </ion-nav-back-button>\n\n          <ion-nav-buttons side="right">\n            <button class="button button-icon button-clear ion-navicon" menu-toggle="right">\n            </button>\n          </ion-nav-buttons>\n        </ion-nav-bar>--> <ion-header-bar class="bar-positive bar-view no-adding" horizontal layout center> <select-language style="margin-right: 20px"></select-language> <div flex></div> <div class="button-add"> <button class="button button-light" ng-click="logOut()"> <i class="mdi mdi-logout"></i> </button> </div> </ion-header-bar> <ion-nav-view name="menuContent"></ion-nav-view> </ion-side-menu-content> <ion-side-menu side="right" class="sidebar-right"> <ion-header-bar class="bar-positive no-padding" horizontal layout> <div class="avatar" ng-click="goProfile()"> <img ng-src="{{rootData.currentUser.avatar}}" alt="" class="img-responsive"> </div> <div class="info-user" flex horizontal layout center ng-click="goProfile()"> <div> <div>{{rootData.currentUser.name}}</div> <div>{{rootData.currentUser.email}}</div> </div> </div> </ion-header-bar> <ion-content style="border-right: 1px solid #C4DAFF" scroll="false" vertical layout> <div flex style="overflow-y: scroll"> <div class="list"> <a class="item item-icon-left item-icon-right" ui-sref="app.newFeed" ui-sref-active="active"> <i class="icon mdi mdi-newspaper"></i> <span>New Feed</span> </a> <a class="item item-icon-left item-icon-right" ui-sref="app.roomChat" ui-sref-active="active"> <i class="icon mdi mdi-comment-multiple-outline"></i> <span>Room Chat</span> </a> <a class="item item-icon-left item-icon-right" ui-sref="app.call" ui-sref-active="active"> <i class="icon mdi mdi-message-video"></i> <span>Call Video</span> </a> <!--<a class="item item-icon-left" ui-sref="app.home" ui-sref-active="active">\n                        <i class="icon ion-ios-home calm"></i>\n                        <span translate="HOME"></span>\n                    </a>--> <a class="item item-icon-left" ui-sref="app.profile" ui-sref-active="active"> <i class="icon mdi mdi-account-circle"></i> <span>Profile</span> </a> <a class="item item-icon-left" ui-sref="app.profileEdit" ui-sref-active="active"> <i class="icon mdi mdi-tooltip-edit"></i> <span>Edit Profile</span> </a> <!--<div class="item item-divider">\n                        Calling\n                    </div>\n                    <a class="item item-icon-left" ui-sref="app.call" ui-sref-active="active">\n                        <i class="icon ion-beaker"></i>\n                        Call view\n                    </a>--> <div class="item item-divider"> Followings </div> <a class="item item-avatar item-follower" ng-repeat="item in rootData.currentUser.follows" ng-click="goProfileUser(item.user._id)"> <img ng-src="{{item.user.avatar}}"> <h2>{{item.user.name}} </h2> </a> </div> </div> <div class="title-menu-left"> <i class="mdi mdi-comment-text-outline balanced"></i> Notifications </div> <div style="height: 250px; overflow-y: scroll" id="scrollNotifications"> <div class="list list-notifications"> <a class="item item-avatar" ng-repeat="item in rootData.notifications | limitTo:15"> <img ng-src="{{item.userFrom.avatar}}" alt=""> <h2 style="white-space: initial" ng-if="item.action == 1 || item.action == 2 || item.action == 5"> <b>{{item.userFrom.name}}</b> <span>{{rootData.actions[item.action]}}</span> {{item.userTo.name}}\'s post </h2> <h2 style="white-space: initial" ng-if="item.action == 3 || item.action == 4"> <b>{{item.userFrom.name}}</b> <span>{{rootData.actions[item.action]}}</span> {{item.userTo.name}} </h2> <h2 style="white-space: initial" ng-if="item.action == 6"> <b>{{item.userFrom.name}}</b> <span>{{rootData.actions[item.action]}}</span> </h2> </a> </div> </div> </ion-content> <!--<ion-footer-bar ng-click="logOut()">\n            <h1 class="title">Log out</h1>\n        </ion-footer-bar>--> </ion-side-menu> </ion-side-menus>'),a.put("views/states/call.html",'<ion-view> <ion-content class="content-view" scroll="false" horizontal layout> <!--<input type="text" placeholder="name 01" ng-model="rootData.name1"/>\n        <input type="text" placeholder="name 02" ng-model="rootData.name2"/>\n        <br/>\n        <video ng-src="{{rootData.remoteVideo.src | trustUrl}}" autoplay></video>\n        <button ng-click="connect()">connect</button>\n        <button ng-click="dial()">dial</button>--> <div flex vertical layout> <div class="header-call" horizontal layout center ng-if="rootData.userCaller._id"> <img ng-src="{{rootData.userCaller.avatar}}" alt="" width="80" height="80"> <div flex> <div class="name-user"><i class="ion ion-ios-star-outline"></i> {{rootData.userCaller.name}}</div> <div ng-if="rootData.userCaller.status"><i class="ion ion-checkmark-circled balanced"></i> Online</div> <div ng-if="!rootData.userCaller.status"><i class="mdi mdi-checkbox-blank-circle-outline"></i> Offline</div> </div> <a class="call-video calm-bg" ng-click="startCall()" ng-if="!data.timeoutCall"> <i class="ion ion-ios-videocam light"></i> </a> <a class="call-video calm-bg" ng-if="data.timeoutCall"> {{data.timeoutCall}} </a> </div> <div class="user-cam" ng-if="rootData.remoteVideo.src"> <video ng-src="{{rootData.remoteVideo.src | trustUrl}}" autoplay width="100%"></video> {{rootData.remoteVideo}} </div> <div ng-if="!rootData.remoteVideo.src" class="padding"> Please select user and call </div> </div> <div class="list-users-chat list-callers"> <div class="my-cam"> <video ng-src="{{rootData.localStream.src | trustUrl}}" autoplay width="100%" muted></video> </div> <div class="list list-inset search-all filter-user"> <label class="item item-input" id="search"> <i class="icon ion-search placeholder-icon"></i> <input type="text" placeholder="Search" for="search" ng-model="search.name"> </label> </div> <div class="list"> <a class="item item-avatar" ng-repeat="item in data.users | filter:search" ng-hide="item._id == rootData.currentUser._id" ng-class="{\'active\': item._id == rootData.userCaller._id}" ng-click="setUserCall(item)"> <img ng-src="{{item.avatar}}"> <h2>{{item.name}} <span>{{item.createdAt | date:\'yyyy-MM-dd HH:mm:ss Z\'}}</span></h2> <span class="online balanced-bg" ng-if="item.status"></span> </a> </div> </div> </ion-content> </ion-view>'),
a.put("views/states/home.html",'<ion-view> <ion-content class="content-view"> <div class="text-home text-center"> <h2>Facebook friends on Skype</h2> <p>To chat with friends on Facebook, simply add them to your Skype contacts below. You\'ll also be able to enjoy free voice and video calls with them too.</p> <h4>YOUR FACEBOOK FRIENDS ON SKYPE</h4> </div> <div class="list-users"> <ul class="padding-8"> <li class="padding-8"> <a horizontal layout> <div class="avatar"> <img src="http://images.thehollywoodgossip.com/iu/s--Kxob852Y--/t_full/f_auto,fl_lossy,q_75/v1364529019/attachment/taylor-swift-ours.png" alt="" class="img-responsive"> </div> <div class="info-user" flex horizontal layout center> <div> <div>Hoang Van Loi</div> <div>Add Credit</div> </div> </div> <div horizontal layout center class="padding-8"> <i class="ion ion-person-add"></i> </div> </a> </li> <li class="padding-8"> <a horizontal layout> <div class="avatar"> <img src="http://images.thehollywoodgossip.com/iu/s--Kxob852Y--/t_full/f_auto,fl_lossy,q_75/v1364529019/attachment/taylor-swift-ours.png" alt="" class="img-responsive"> </div> <div class="info-user" flex horizontal layout center> <div> <div>Hoang Van Loi</div> <div>Add Credit</div> </div> </div> <div horizontal layout center class="padding-8"> <i class="ion ion-person-add"></i> </div> </a> </li> <li class="padding-8"> <a horizontal layout> <div class="avatar"> <img src="http://images.thehollywoodgossip.com/iu/s--Kxob852Y--/t_full/f_auto,fl_lossy,q_75/v1364529019/attachment/taylor-swift-ours.png" alt="" class="img-responsive"> </div> <div class="info-user" flex horizontal layout center> <div> <div>Hoang Van Loi</div> <div>Add Credit</div> </div> </div> <div horizontal layout center class="padding-8"> <i class="ion ion-person-add"></i> </div> </a> </li> <li class="padding-8"> <a horizontal layout> <div class="avatar"> <img src="http://images.thehollywoodgossip.com/iu/s--Kxob852Y--/t_full/f_auto,fl_lossy,q_75/v1364529019/attachment/taylor-swift-ours.png" alt="" class="img-responsive"> </div> <div class="info-user" flex horizontal layout center> <div> <div>Hoang Van Loi</div> <div>Add Credit</div> </div> </div> <div horizontal layout center class="padding-8"> <i class="ion ion-person-add"></i> </div> </a> </li> <li class="padding-8"> <a horizontal layout> <div class="avatar"> <img src="http://images.thehollywoodgossip.com/iu/s--Kxob852Y--/t_full/f_auto,fl_lossy,q_75/v1364529019/attachment/taylor-swift-ours.png" alt="" class="img-responsive"> </div> <div class="info-user" flex horizontal layout center> <div> <div>Hoang Van Loi</div> <div>Add Credit</div> </div> </div> <div horizontal layout center class="padding-8"> <i class="ion ion-person-add"></i> </div> </a> </li> <li class="padding-8"> <a horizontal layout> <div class="avatar"> <img src="http://images.thehollywoodgossip.com/iu/s--Kxob852Y--/t_full/f_auto,fl_lossy,q_75/v1364529019/attachment/taylor-swift-ours.png" alt="" class="img-responsive"> </div> <div class="info-user" flex horizontal layout center> <div> <div>Hoang Van Loi</div> <div>Add Credit</div> </div> </div> <div horizontal layout center class="padding-8"> <i class="ion ion-person-add"></i> </div> </a> </li> <li class="padding-8"> <a horizontal layout> <div class="avatar"> <img src="http://images.thehollywoodgossip.com/iu/s--Kxob852Y--/t_full/f_auto,fl_lossy,q_75/v1364529019/attachment/taylor-swift-ours.png" alt="" class="img-responsive"> </div> <div class="info-user" flex horizontal layout center> <div> <div>Hoang Van Loi</div> <div>Add Credit</div> </div> </div> <div horizontal layout center class="padding-8"> <i class="ion ion-person-add"></i> </div> </a> </li> </ul> </div> </ion-content> </ion-view>'),a.put("views/states/new_feed.html",'<ion-view> <ion-content class="content-view bg-gray"> <div style="padding: 20px 40px"> <form class="card create-status" name="formCreateStatus"> <div class="header-status" horizontal layout center> <i class="mdi mdi-message-draw positive"></i> Status </div> <div class="content-status"> <textarea name="" id="" cols="30" rows="3" placeholder="What\'s on your mind?" ng-model="data.status.status" required></textarea> </div> <div class="album-status" ng-if="data.status.albums.length"> <ul class="list-inline"> <li ng-repeat="item in data.status.albums"> <img ng-src="{{item.url}}" alt="" width="80" height="80"> </li> </ul> </div> <div class="footer-status" horizontal layout center> <label for="uploadStatus"> <i class="mdi mdi-camera"></i> <input type="file" hidden id="uploadStatus" ngf-select ng-model="data.file" name="file" accept="image/*" ngf-max-size="10MB"> </label> <div flex></div> <button class="button button-light button-small" type="submit" ng-disabled="formCreateStatus.$invalid" ng-click="createStatus()"> Public </button> </div> </form> <div class="list card" ng-repeat="item in data.posts"> <div class="item item-avatar"> <img ng-src="{{item.user.avatar}}" ng-click="goProfileUser(item.user._id)"> <h2>{{item.user.name}}</h2> <p>{{item.createdAt | date:\'yyyy-MM-dd HH:mm:ss Z\'}}</p> </div> <div class="item item-body"> <p class="status-item"> {{item.status}} </p> <div class="status-album" ng-if="item.albums.length"> <ul> <li ng-repeat="img in item.albums"><img ng-src="{{img.url}}" alt="" class="img-responsive"></li> </ul> </div> <p class="m-b-5"> <a class="subdued" ng-click="addLike(item)">{{item.likes.length}} Like</a> <a class="subdued">{{item.comments.length}} Comments</a> </p> <div class="list-social"> <ul class="list-inline"> <li ng-click="addLike(item)" ng-class="{positive: userLike(item)}"><i class="ion ion-thumbsup"></i> Like</li> <li><i class="ion ion-chatboxes"></i> Comments</li> </ul> </div> </div> <div class="footer-comment"> <div class="list-like" ng-if="item.likes.length"> <ul class="list-inline"> <li ng-repeat="like in item.likes"> <a ng-click="goProfileUser(item.user._id)">{{like.user.name}} <span ng-hide="$index == (item.likes.length - 1)">,</span></a> </li> </ul> <span>Like this</span> </div> <div class="view-comments" ng-hide="item.limit == item.comments.length || item.comments.length < 3"> <a ng-click="viewComments(item)">View all comments</a> <span class="pull-right">3 of {{item.comments.length}}</span> </div> <div class="list-comment"> <div class="item-comment" horizontal layout ng-repeat="comment in item.comments | limitTo:item.limit || -3 "> <img ng-src="{{comment.user.avatar}}"> <div> <div class="comment-content">{{comment.comment}} </div> <p class="time-ago-comment">{{comment.createdAt | date:\'yyyy-MM-dd HH:mm:ss Z\'}}</p> </div> </div> </div> <form class="new-comment" horizontal layout center ng-submit="addComment(item, $index)" ng-class="{\'p-t-15\': !item.comments.length}"> <img ng-src="{{rootData.user.avatar}}"> <input type="text" placeholder="Write a comment" ng-model="data.newComment[$index].comment"> </form> </div> </div> </div> </ion-content> </ion-view>'),a.put("views/states/profile.html",'<ion-view> <ion-content class="content-view bg-gray"> <div class="padding"> <div class="header-profile"> <img ng-src="{{data.profile.cover}}" alt="" class="img-responsive"> <div class="avatar-profile"> <div class="img-profile"> <img ng-src="{{data.profile.avatar}}" alt="" class="img-responsive"> <label for="upload" ng-if="data.profile._id == rootData.currentUser._id"> <input type="file" hidden id="upload" ngf-select ng-model="data.fileAvatar" name="file" accept="image/*" ngf-max-size="10MB"> <i class="mdi mdi-camera"></i> </label> </div> </div> <label for="uploadCover" ng-if="data.profile._id == rootData.currentUser._id"> <input type="file" hidden id="uploadCover" ngf-select ng-model="data.fileCover" name="file" accept="image/*" ngf-max-size="10MB"> <i class="mdi mdi-camera"></i> </label> <div class="user-name"> {{data.profile.name}} </div> <button class="button button-small button-assertive button-follow" horizontal layout center ng-click="follow()" ng-if="data.profile._id != rootData.currentUser._id"> <span ng-if="!data.profile.isFollow">Follow <i class="mdi mdi-account-plus"></i></span> <span ng-if="data.profile.isFollow"><i class="mdi mdi-check" style="margin: 0"></i> Following</span> </button> </div> <div class="content-profile" horizontal layout> <div class="left-profile"> <div class="card list-info"> <ul> <li class="item-text-wrap" ng-if="data.profile.workAt"> <i class="mdi mdi-archive"></i> Work at <span>{{data.profile.workAt}}</span> </li> <li class="item-text-wrap" ng-if="data.profile.studyAt"> <i class="mdi mdi-school"></i> Studied at <span>{{data.profile.studyAt}}</span> </li> <li class="item-text-wrap" ng-if="data.profile.address"> <i class="mdi mdi-home-variant"></i> Lives in <span>{{data.profile.address}}</span> </li> <li class="item-text-wrap" ng-if="data.profile.birthday"> <i class="mdi mdi-calendar-text"></i> Born on <span>{{data.profile.birthday | date:\'yyyy-MM-dd Z\'}}</span> </li> </ul> </div> <div class="list card photos"> <div class="item header-photo" horizontal layout center> <span class="balanced-bg"><i class="mdi mdi-folder-multiple-image"></i> </span> Photos <span ng-if="!data.albums.length" class="no-photo">(no photo)</span> </div> <div class="item content-photo" ng-if="data.albums.length"> <div class="img-album" ng-repeat="item in data.albums | limitTo:9"> <img ng-src="{{item.url}}" alt="" class="img-responsive"> </div> </div> </div> <div class="list card photos"> <div class="item header-photo" horizontal layout center> <span class="assertive-bg"><i class="mdi mdi-account-multiple"></i> </span> Followers <span class="no-photo">({{data.profile.follows.length || 0}})</span> </div> <div class="item content-friend" ng-if="data.profile.follows.length"> <div class="item-friend" ng-repeat="item in data.profile.follows | limitTo:9" ng-click="goProfileUser(item.user._id)"> <div class="data-friend"> <img ng-src="{{item.user.avatar}}" alt="" class="img-responsive"> <div class="name-friend"> {{item.user.name}} </div> </div> </div> </div> </div> </div> <div class="right-profile" flex> <form class="card create-status" name="formCreateStatus" ng-if="data.profile._id == rootData.currentUser._id"> <div class="header-status" horizontal layout center> <i class="mdi mdi-message-draw positive"></i> Status </div> <div class="content-status"> <textarea name="" id="" cols="30" rows="3" placeholder="What\'s on your mind?" ng-model="data.status.status" required></textarea> </div> <div class="album-status" ng-if="data.status.albums.length"> <ul class="list-inline"> <li ng-repeat="item in data.status.albums"> <img ng-src="{{item.url}}" alt="" width="80" height="80"> </li> </ul> </div> <div class="footer-status" horizontal layout center> <label for="uploadStatus"> <i class="mdi mdi-camera"></i> <input type="file" hidden id="uploadStatus" ngf-select ng-model="data.file" name="file" accept="image/*" ngf-max-size="10MB"> </label> <div flex></div> <button class="button button-light button-small" type="submit" ng-disabled="formCreateStatus.$invalid" ng-click="createStatus()"> Public </button> </div> </form> <div class="list card" ng-repeat="item in data.posts"> <div class="item item-avatar"> <img ng-src="{{item.user.avatar}}"> <h2>{{item.user.name}}</h2> <p>{{item.createdAt | date:\'yyyy-MM-dd HH:mm:ss Z\'}}</p> </div> <div class="item item-body"> <p class="status-item"> {{item.status}} </p> <div class="status-album" ng-if="item.albums.length"> <ul> <li ng-repeat="img in item.albums"><img ng-src="{{img.url}}" alt="" class="img-responsive"></li> </ul> </div> <p class="m-b-5"> <a class="subdued" ng-click="addLike(item)">{{item.likes.length}} Like</a> <a class="subdued">{{item.comments.length}} Comments</a> </p> <div class="list-social"> <ul class="list-inline"> <li ng-click="addLike(item)" ng-class="{positive: userLike(item)}"><i class="ion ion-thumbsup"></i> Like</li> <li><i class="ion ion-chatboxes"></i> Comments</li> </ul> </div> </div> <div class="footer-comment"> <div class="list-like" ng-if="item.likes.length"> <ul class="list-inline"> <li ng-repeat="like in item.likes"> <a>{{like.user.name}} <span ng-hide="$index == (item.likes.length - 1)">,</span></a> </li> </ul> <span>Like this</span> </div> <div class="view-comments" ng-hide="item.limit == item.comments.length || !item.comments.length"> <a ng-click="viewComments(item)">View all comments</a> <span class="pull-right">3 of {{item.comments.length}}</span> </div> <div class="list-comment"> <div class="item-comment" horizontal layout ng-repeat="comment in item.comments | limitTo:item.limit || -3 "> <img ng-src="{{comment.user.avatar}}"> <div> <div class="comment-content">{{comment.comment}} </div> <p class="time-ago-comment">{{comment.createdAt | date:\'yyyy-MM-dd HH:mm:ss Z\'}}</p> </div> </div> </div> <form class="new-comment" horizontal layout center ng-submit="addComment(item, $index)" ng-class="{\'p-t-15\': !item.comments.length}"> <img ng-src="{{rootData.user.avatar}}"> <input type="text" placeholder="Write a comment" ng-model="data.newComment[$index].comment"> </form> </div> </div> </div> </div> </div> </ion-content> </ion-view>'),a.put("views/states/profile_edit.html",'<ion-view> <ion-content class="content-view bg-gray"> <div class="padding profile-edit"> <div class="card padding"> <form name="formProfile"> <div class="form-group"> <label for="exampleInputEmail1">Full name</label> <input type="text" class="form-control" id="exampleInputEmail1" placeholder="Full Name" ng-model="data.profile.name"> </div> <div class="form-group"> <label for="exampleInputPassword2">Work at</label> <input type="text" class="form-control" id="exampleInputPassword2" placeholder="Work at" ng-model="data.profile.workAt"> </div> <div class="form-group"> <label for="exampleInputPassword3">Studied at</label> <input type="text" class="form-control" id="exampleInputPassword3" placeholder="Studied at" ng-model="data.profile.studyAt"> </div> <div class="form-group"> <label for="exampleInputPassword4">Lives in</label> <input type="text" class="form-control" id="exampleInputPassword4" placeholder="Lives in" ng-model="data.profile.address"> </div> <div class="form-group pick-date"> <label>Born on</label> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup="{{format}}" ng-model="data.profile.birthday" is-open="popup1.opened" datepicker-options="dateOptions" ng-required="true" close-text="Close" alt-input-formats="altInputFormats"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="open1()"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <div> <button class="button button-positive button-small" ng-click="updateProfile()" style="padding: 5px 20px"> Save </button> </div> </form> </div> </div> </ion-content> </ion-view>'),a.put("views/states/room_chat.html",'<ion-view> <ion-content class="content-view" scroll="false" horizontal layout> <div flex class="content-chat" vertical layout> <div class="list-message" flex id="scrollRoomChat"> <div class="list"> <a class="item item-avatar" ng-repeat="item in data.chats"> <img ng-src="{{item.user.avatar}}" ng-click="goProfileUser(item.user._id)"> <h2>{{item.user.name}} <span>{{item.createdAt | date:\'yyyy-MM-dd HH:mm:ss Z\'}}</span></h2> <p>{{item.message}}</p> </a> </div> </div> <form class="write-message" name="chatMessage" ng-submit="enterChat()"> <input type="text" placeholder="Write message..." required ng-model="data.message.message"> </form> </div> <div class="list-users-chat"> <div class="list list-inset search-all filter-user"> <label class="item item-input" id="search"> <i class="icon ion-search placeholder-icon"></i> <input type="text" placeholder="Search" for="search" ng-model="search.name"> </label> </div> <div class="list"> <a class="item item-avatar" ng-repeat="item in data.users | filter:search" ng-hide="item._id == rootData.currentUser._id" ng-click="goProfileUser(item._id)"> <img ng-src="{{item.avatar}}"> <h2>{{item.name}} <span>{{item.createdAt | date:\'yyyy-MM-dd HH:mm:ss Z\'}}</span></h2> <span class="online balanced-bg" ng-if="item.status"></span> </a> </div> </div> </ion-content> </ion-view>')}]);